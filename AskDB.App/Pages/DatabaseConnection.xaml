<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="AskDB.App.DatabaseConnection"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:AskDB.App"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:animatedvisuals="using:Microsoft.UI.Xaml.Controls.AnimatedVisuals"
    mc:Ignorable="d"
    NavigationCacheMode="Required">

    <Grid x:Name="RootGrid" MaxWidth="1000">
        <StackPanel x:Name="MainPanel" Spacing="16" VerticalAlignment="Center"
            Background="{ThemeResource SolidBackgroundFillColorQuarternaryBrush}"
            CornerRadius="{StaticResource OverlayCornerRadius}"
            Padding="40">
            <TextBlock Text="Connect to your database" Style="{StaticResource TitleTextBlockStyle}"  FontWeight="Bold"/>
            <RichTextBlock>
                <Paragraph>AskDB needs to connect to your database to analyze its structure and execute database queries. Please fill the fields below to configure your database connection.</Paragraph>
            </RichTextBlock>
            <StackPanel/>
            <ComboBox Header="Database Type" x:Name="DatabaseTypeComboBox" SelectedIndex="0" HorizontalAlignment="Stretch">
                <ComboBox.Items>
                    <ComboBoxItem Content="SQL Server"/>
                    <ComboBoxItem Content="MySQL"/>
                    <ComboBoxItem Content="PostgreSQL"/>
                    <ComboBoxItem Content="SQLite"/>
                </ComboBox.Items>
            </ComboBox>
               <StackPanel x:Name="NotSqliteComponents" Spacing="16">
                <Grid ColumnSpacing="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBox Header="Server" Grid.Column="0" Text="{x:Bind _dbCredential.Server, Mode=TwoWay}" PlaceholderText="localhost"/>
                    <TextBox Header="Database" Grid.Row="1" Grid.Column="2" MinWidth="250" Text="{x:Bind _dbCredential.Database, Mode=TwoWay}"/>
                </Grid>
                <StackPanel Spacing="2">
                    <Grid ColumnSpacing="12" x:Name="CustomAuthenticationSpace" Padding="16" CornerRadius="{StaticResource ControlCornerRadius}" Background="{ThemeResource LayerOnMicaBaseAltFillColorSecondaryBrush}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox Header="Username" Grid.Column="0" Text="{x:Bind _dbCredential.Username,Mode=TwoWay}" PlaceholderText="{x:Bind _defaultUsername, Mode=TwoWay}"/>
                        <PasswordBox Header="Password" AutomationProperties.Name="Simple PasswordBox" Grid.Column="1" MinWidth="250" Password="{x:Bind _dbCredential.Password, Mode=TwoWay}"/>
                    </Grid>
                    <CheckBox Content="I want to use Windows Authentication." IsChecked="{x:Bind _useWindowsAuthentication, Mode=TwoWay}" Click="UseWindowsAuthenticationCheckbox_Click"/>
                    <CheckBox Content="Enable SSL/TLS encryption." Grid.Row="1" IsChecked="{x:Bind _enableSslTls,Mode=TwoWay}"/>
                </StackPanel>
                <TextBox Header="Connection String" x:Name="ConnectionStringBox" Visibility="Collapsed" ToolTipService.ToolTip="You can edit this connection string in case you can't connect to your database."/>
            </StackPanel>
            <Grid x:Name="SqliteComponents" Visibility="Collapsed">
                <Grid ColumnSpacing="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox PlaceholderText="path\\to\\YourDatabaseFile.db" IsReadOnly="True" x:Name="databaseFileBox" Grid.Column="0"/>
                    <Button Content="Browse" x:Name="BrowseButton" Grid.Column="1"/>
                </Grid>
            </Grid>
            <Button HorizontalAlignment="Stretch" x:Name="ContinueButton"  Content="Continue" Grid.Column="2" Style="{StaticResource AccentButtonStyle}" Padding="8"/>
        </StackPanel>
        <local:LoadingControl x:Name="LoadingOverlay" HorizontalAlignment="Center" VerticalAlignment="Center"/>
    </Grid>
</Page>
